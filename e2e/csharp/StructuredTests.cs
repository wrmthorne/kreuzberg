// Code generated by kreuzberg-e2e-generator. DO NOT EDIT.
using System;
using System.Collections.Generic;
using System.IO;
using System.Threading.Tasks;
using Kreuzberg;
using Xunit;
using Kreuzberg.E2E;

namespace Kreuzberg.E2E.Structured {
    public class StructuredTests
    {
        [SkippableFact]
        public void StructuredCsvBasic()
        {
            TestHelpers.SkipIfLegacyOfficeDisabled("csv/stanley_cups.csv");
            TestHelpers.SkipIfOfficeTestOnWindows("csv/stanley_cups.csv");
            var documentPath = TestHelpers.EnsureDocument("csv/stanley_cups.csv", true);
            var config = TestHelpers.BuildConfig(null);

            var result = KreuzbergClient.ExtractFileSync(documentPath, config);
            TestHelpers.AssertExpectedMime(result, new[] { "text/csv" });
            TestHelpers.AssertMinContentLength(result, 20);
        }

        [SkippableFact]
        public void StructuredJsonBasic()
        {
            TestHelpers.SkipIfLegacyOfficeDisabled("json/sample_document.json");
            TestHelpers.SkipIfOfficeTestOnWindows("json/sample_document.json");
            var documentPath = TestHelpers.EnsureDocument("json/sample_document.json", true);
            var config = TestHelpers.BuildConfig(null);

            var result = KreuzbergClient.ExtractFileSync(documentPath, config);
            TestHelpers.AssertExpectedMime(result, new[] { "application/json" });
            TestHelpers.AssertMinContentLength(result, 20);
            TestHelpers.AssertContentContainsAny(result, new[] { "Sample Document", "Test Author" });
        }

        [SkippableFact]
        public void StructuredJsonSimple()
        {
            TestHelpers.SkipIfLegacyOfficeDisabled("data_formats/simple.json");
            TestHelpers.SkipIfOfficeTestOnWindows("data_formats/simple.json");
            var documentPath = TestHelpers.EnsureDocument("data_formats/simple.json", true);
            var config = TestHelpers.BuildConfig(null);

            var result = KreuzbergClient.ExtractFileSync(documentPath, config);
            TestHelpers.AssertExpectedMime(result, new[] { "application/json" });
            TestHelpers.AssertMinContentLength(result, 10);
            TestHelpers.AssertContentContainsAny(result, new[] { "{", "name" });
        }

        [SkippableFact]
        public void StructuredTomlBasic()
        {
            TestHelpers.SkipIfLegacyOfficeDisabled("data_formats/cargo.toml");
            TestHelpers.SkipIfOfficeTestOnWindows("data_formats/cargo.toml");
            var documentPath = TestHelpers.EnsureDocument("data_formats/cargo.toml", true);
            var config = TestHelpers.BuildConfig(null);

            var result = KreuzbergClient.ExtractFileSync(documentPath, config);
            TestHelpers.AssertExpectedMime(result, new[] { "application/toml", "text/toml" });
            TestHelpers.AssertMinContentLength(result, 10);
        }

        [SkippableFact]
        public void StructuredYamlBasic()
        {
            TestHelpers.SkipIfLegacyOfficeDisabled("yaml/simple.yaml");
            TestHelpers.SkipIfOfficeTestOnWindows("yaml/simple.yaml");
            var documentPath = TestHelpers.EnsureDocument("yaml/simple.yaml", true);
            var config = TestHelpers.BuildConfig(null);

            var result = KreuzbergClient.ExtractFileSync(documentPath, config);
            TestHelpers.AssertExpectedMime(result, new[] { "application/yaml", "text/yaml", "text/x-yaml", "application/x-yaml" });
            TestHelpers.AssertMinContentLength(result, 10);
        }

        [SkippableFact]
        public void StructuredYamlSimple()
        {
            TestHelpers.SkipIfLegacyOfficeDisabled("data_formats/simple.yaml");
            TestHelpers.SkipIfOfficeTestOnWindows("data_formats/simple.yaml");
            var documentPath = TestHelpers.EnsureDocument("data_formats/simple.yaml", true);
            var config = TestHelpers.BuildConfig(null);

            var result = KreuzbergClient.ExtractFileSync(documentPath, config);
            TestHelpers.AssertExpectedMime(result, new[] { "application/x-yaml" });
            TestHelpers.AssertMinContentLength(result, 10);
        }

    }
}
